var Lolipop={};console.assert=console.assert||function(){},function(){function e(e){return"string"==typeof e}function t(e){return"function"==typeof e}function n(e){return e=e.replace(/\[m=([a-z]+),?([a-zA-Z ]*)\]/g,'<span class="symbol outlined" title="$2" style="background-image: url(\'img/mobile/monster-$1.jpg\');"></span>'),e=e.replace(/\[mick\]/g,'<span class="symbol" title="Smashing the minion" style="background-image: url(\'img/mobile/mick48.png\');"></span>'),e=e.replace(/\*\*([^*]*)\*\*/g,'<strong class="double">$1</strong>'),e=e.replace(/\*([^*]*)\*/g,"<strong>$1</strong>")}var a,r=!0,o={},i=BigNumber;!function(){var e=(new Date).getTime().toString(35),t=0;a=function(){return e+"z"+(t++).toString(35)}}();var s=function(e){arguments[0]=e,console.assert.apply(console,arguments)};Lolipop.GUID=function(){return a()};var l={};!function(){var n={};if(l.addListener=function(a,r,o){var i=o||r,s=o?r:null;if(!e(a))throw new Error("Events.addListener: event type must be of type string.");if(!t(i))throw new Error("Events.addListener: callback must be a function.");if(s&&!e(s))throw new Error("Events.addListener: target must be of type string.");var l={f:i};s&&(l.target=s);var u=n[a]=n[a]||[];return u.push(l),l},l.addExternalListener=function(e,t,n){var a=l.addListener(e,t,n);return a&&(a.ext=!0),a},l.removeListener=function(a,r,o){var i=o||r,s=o?r:null;if(!e(a))throw new Error("Events.removeListener: event type must be of type string.");if(!t(i))throw new Error("Events.removeListener: callback must be a function.");if(s&&!e(s))throw new Error("Events.removeListener: target must be of type string.");var l=n[a];l&&(l=l.filter(function(e){return!(e.f===i&&(!s&&!e.target||s===e.target))}),l.length>0?n[a]=l:delete n[a])},l.dispatch=function(t,a,r,o){if(o=o||!1,!e(t))throw new Error("Events.dispatch: event type must be of type string.");if(a&&!e(a))throw new Error("Events.dispatch: target should be a string or null.");var i=n[t];if(i)for(var s in i){var l=i[s];l.target&&l.target!==a||!o&&(o||l.ext)||!function(){var e={name:t,target:a,data:r||null},n=l.f;setTimeout(function(){n(e)},1)}()}},r){console.log(">>>> TESTS EVENTS - START <<<<");var a=function(e){};l.addListener("type","target",a),s(n.type),s(n.type[0]),s(n.type[0].f===a),s("target"===n.type[0].target),l.removeListener("type",a),s(n.type),l.removeListener("type","target",a),s(!n.type),l.addListener("type2",a),s(n.type2),s(n.type2[0]),s(n.type2[0].f===a),s(!n.type2[0].target),l.removeListener("type2","bblabla",a),s(n.type2),l.removeListener("type2",a),s(!n.type2),console.log(">>>> TESTS EVENTS - END <<<<")}}();var u={};u.Stone={},u.Variables={},u.Pedia={},u.Variables.Index={},u.Variables.Levels=[],u.Variables.setRequirements=function(e,t,n){if(e.requires&&!n){for(var a in e.requires)delete e[e.requires[a]];delete e.requires}if(t){e.requires=n?e.requires.concat(t):t;for(var a in t){var r=t[a];e[r]=e[r]||u.Variables.Index[r]||u.registerVar(r),e[r].requiredBy.push(e)}}},u.Variables.addRequirement=function(e,t){u.Variables.setRequirements(e,[t],!0)},u.Variables.removeRequirement=function(e,t){delete e[t],e.requires=e.requires.filter(function(e){return e!=t}),u.Variables.Index[t].requiredBy.filter(function(t){return t!=e})},u.Variables.addInvalidator=function(e,t){var n=u.Variables.Index[t];n||(n=u.registerVar(t)),n.invalidates.push(e),e.isRoot=!1,e.invalidators.push(t)},u.Variables.removeInvalidator=function(e,t){var n=u.Variables.Index[t];n&&(n.invalidates=n.invalidates.filter(function(t){return t!==e})),e.invalidators=e.invalidators.filter(function(e){return e!=t})},u.registerVar=function(e,t,n,a,r){var o=u.Variables.Index[e]||(u.Variables.Index[e]={});o.id=e,o.value=t||new i(0),o.updateFunc=a?function(){return a.apply(o,arguments)?(u.updateVarUses(e),!0):void 0}:function(){console.log(o.id,a,"CALLED_INEXISTANT_UPDATE_FUNCTION")},"statistics.upgrade.discovered"==e&&console.log(e,t,n,a,o.updateFunc,r),o.invalidates||(o.invalidates=[]),o.invalidators||(o.invalidators=[]),o.requiredBy||(o.requiredBy=[]),o.isRoot="undefined"==typeof o.isRoot?!0:o.isRoot,n&&n.length>0&&(o.isRoot=!1);for(var s in n)u.Variables.addInvalidator(o,n[s]);return u.Variables.setRequirements(o,r),o},u.registerRelayVar=function(e,t,n){return u.registerVar(e,null,t,function(t){return this.value=t.value,n&&console.log("relay",e,t.id,t.value.toString()),!0},null)},u.registerFloorRelayVar=function(e,t){return u.registerVar(e,null,t,function(e){var t=e.value.floor();return this.value.eq(t)?!1:(this.value=t,!0)},null)},u.registerConditionalRelayVar=function(e,t,n,a){return u.registerVar(e,null,t,function(e){var t=this;return a.apply(this,n.map(function(e){return t[e].value}))?(this.value=e.value,!0):void 0},n)},u.registerConditionalRootVar=function(e,t,n){return u.registerVar(e,null,null,function(){var e=this;return n.apply(this,t.map(function(t){return e[t].value}))},t)},u.registerLTVar=function(e,t,n){return"object"==typeof n&&"undefined"!=typeof n.e?u.registerVar(e,!1,[t],function(){var e=this[t].value.lt(n);return this.value&&!e||!this.value&&e?(this.value=e,!0):!1},[t]):u.registerVar(e,!1,[t,n],function(){var e=this[t].value.lt(this[n].value);return this.value&&!e||!this.value&&e?(this.value=e,!0):!1},[t,n])},u.registerGTEVar=function(e,t,n){return"object"==typeof n&&"undefined"!=typeof n.e?u.registerVar(e,!1,[t],function(){var e=this[t].value.gte(n);return this.value&&!e||!this.value&&e?(this.value=e,!0):!1},[t,n]):u.registerVar(e,!1,[t,n],function(){var e=this[t].value.gte(this[n].value);return this.value&&!e||!this.value&&e?(this.value=e,!0):!1},[t,n])},u.registerConstant=function(e,t){return u.registerVar(e,t,null,function(){return!1},null)},u.registerSumVar=function(e,t){return u.registerVar(e,null,t,function(){this.value=new i(0);for(var e in this.invalidators)this.value=this.value.plus(this[this.invalidators[e]].value);return!0},t)},u.registerProductVar=function(e,t,n,a){return n=n?n.concat(t):t,u.registerVar(e,null,t,function(){a&&console.log("UPDATE",e),this.value=new i(1);for(var t in this.requires)this.value=this.value.times(this[this.requires[t]].value);return!0},n)},u.registerAddVar=function(e,t,n){return u.registerVar(e,null,[t],function(e){return this.value=e.value.plus(n),!0},null)},u.registerFlipFlopTrigger=function(e,t,n){return u.registerVar(e,null,t,function(e){var a=!0;for(var e in t)a=a||this[t[e]].value;return a?(n.apply(this),!0):void 0},t)},u.registerSimpleTrigger=function(e,t,n){return u.registerVar(e,null,[t],function(){return n.apply(this),!0},[t])},u.registerSpongeVar=function(e,t){return u.registerVar(e,new i(0),Object.keys(t),function(e){try{var n=new i(0);if("string"==typeof t[e.id]){var a=t[e.id].match(/([+-]?)([a-z]+)/);if(3!=a.length)return s(!1,"Failed to update Sponge, bad selector",t[e.id]),!1;switch(a[2]){case"current":n=this.value;break;case"value":n=e.value}"-"==a[1]&&(n=n.times(-1))}else n=new i(0).plus(t[e.id]);if(this.value=this.value.plus(n),!n.eq(0))return!0}catch(r){console.log("Failed to update sponge var :",this.id,e,r)}return!1},null)},u.registerPriceComputerVar=function(e,t,n,a){var r=[t,n,a];return u.registerVar(e,null,r,function(){return this.value=this[t].value.times(this[n].value.pow(this[a].value)).floor(),!0},r)},u.registerPrice10ComputerVar=function(e,t,n,a){var r=[t,n,a];return u.registerVar(e,null,r,function(){this.value=new i(0);for(var e=0;10>e;++e)this.value=this.value.plus(this[t].value.times(this[n].value.pow(this[a].value.plus(e))).floor());return!0},r)},u.registerRefundComputerVar=function(e,t,n,a){var r=[t,n,a];return u.registerVar(e,null,r,function(){return this[a].value.eq(0)?(this.value=new i(0),!0):(this.value=this[t].value.times(this[n].value.pow(this[a].value.minus(1))).floor(),!0)},r)},u.registerRefundAllComputerVar=function(e,t,n,a){var r=[t,n,a];return u.registerVar(e,null,r,function(){var e=this[a].value.toNumber();if(this.value=new i(0),this[a].value.eq(0))return!0;for(var r=0;e>r;++r)this.value=this.value.plus(this[t].value.times(this[n].value.pow(r)).floor());return!0},r)},u.registerIncrementVar=function(e,t){return u.registerVar(e,new i(0),t,function(){return console.log("UPDATING",e),this.value=this.value.plus(1),!0})},u.unregisterVar=function(e){if(e="string"==typeof e?u.Variables.Index[e]:e){var t=e.invalidates.slice();t.map(function(t){u.Variables.removeInvalidator(t,e.id)});var n=e.invalidators.slice();n.map(function(t){u.Variables.removeInvalidator(e,t)});var a=e.requiredBy.slice();a.map(function(t){u.Variables.removeRequirement(t,e.id)}),delete u.Variables.Index[e.id]}},u.registerMilestoneVar=function(e,t){},u.Variables.changeId=function(e,t,n){},u.value=function(e){return u.Variables.Index[e]?u.Variables.Index[e].value:null},u.updateVar=function(e,t,n,a){var r="object"==typeof e?e:u.Variables.Index[e];if(a&&console.log("updateVar:v",r,"invalidator",n,r.updateFunc),r&&(r.isRoot||void 0==t||(r.value=t),r.isRoot&&r.updateFunc(t)||!r.isRoot&&(!r.updateFunc||!n||n&&r.updateFunc(n)))){a&&console.log("UPDATED",r.id,r,r.invalidates);var o=r.invalidates.slice();for(var i in o)u.updateVar(o[i],void 0,r,a);return!0}},u.varUses={},u.newVarUse=function(e,t){var n=u.varUses[e]||(u.varUses[e]=[]);n.push(t)},u.newOneTimeUse=function(e,t){var n;n=function(a){t(a),u.varUses[e]=u.varUses[e].filter(function(e){return e!=n})},u.newVarUse(e,n)},u.newMilestoneUse=function(e,t){var n=u.Variables.Index[e],a=n?n.value:!1;"boolean"==typeof a&&a?t(n):u.newOneTimeUse(e,t)},u.updateVarUses=function(e){var t=u.Variables.Index[e]||{},n=u.varUses[e]||[];n.map(function(e){e(t)}),$(".gamedata[data-id='"+e+"']").each(function(){var e=u.Formatting.Functions[$(this).attr("data-format-function")]||u.Formatting.Functions["default"];$(this).html(e(t.value))}),$(".conditional-format[data-condition='"+e+"']").each(function(){$(this).toggleClass($(this).attr("data-format-class"),t.value)})},BigNumber.config({DECIMAL_PLACES:3}),u.Formatting={},u.Formatting.Functions={},u.Formatting.Functions.raw=function(e){return e},u.Formatting.Functions.toString=function(e){return e?e.toString():"ERR_TOSTRING"},u.Formatting.Functions.wholeNumber=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},u.Formatting.Functions.shortWhole=function(e){return e.toString()},u.Formatting.Functions.wholeNumberSpan=function(e){return"<span class='e"+e.e+"'>"+e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+"</span>"},u.Formatting.powers=["M.","B.","Tr.","Quad.","Quin.","Sex.","Sept.","Oct.","Non.","Dec."],u.Formatting.Functions.abbreviatedNumber=function(e){if(e.e<6)return u.Formatting.Functions.wholeNumber(e);var t=Math.floor((e.e-6)/3);return e.dividedBy("1e"+(6+3*t)).toFixed(3).toString()+" "+(u.Formatting.powers[t]||"e"+(6+3*t))},u.Formatting.Functions.abbreviatedNumberPerSecond=function(e){return e.eq(0)?"":u.Formatting.Functions.abbreviatedNumber(e)+"<small> /s</small>"},u.Formatting.UAPowers=["","k","M","B","T","Qa","Qi","Sx","Sp","Oc","No","De"],u.Formatting.Functions.ultraAbbreviated=function(e){if(e.gte(1)){var t=Math.floor(e.e/3),n=e.dividedBy("1e"+3*t).toFixed(3).toString();return n.substring(0,3).replace(/[.]0*$/,"")+u.Formatting.UAPowers[t]||"e"+3*t}return e.toFixed(2).replace(/[.]?0*$/,"")},u.Formatting.powersLitterals=[" "," ","Million","Billion","Trillion","Quadrillion","Sextillion","Septillion","Octillion","Nonillion","Decillion"],u.Formatting.Functions.powerLitteral=function(e){var t=Math.floor(e.e/3);return u.Formatting.powersLitterals[t]||"e"+3*t},u.Formatting.Functions["default"]=u.Formatting.Functions.raw,u.Load=function(e){for(var t in e)u.updateVar(t,e[t]),u.Variables.Index[t]&&s(u.Variables.Index[t].value===e[t],"Failed to load",t)};var c=new function(){return list={},function(e,t){var n="milestone."+e,a=list[e];a||(a=list[e]=u.registerVar(n,null,[e],function(e){for(var t=function(){return!0};this.milestones&&this.milestones.length>0;){var a=this.milestones[this.milestones.length-1];if(!e.value.gte(a[1]))break;var r=n+"."+a[0];console.log("Milestone reached !",r,u.Variables.Index[r]),u.registerVar(r,!0,null,t),u.updateVar(r),this.milestones.pop()}}),a.milestones=[],a.ids={});var r=t.toString();return a.ids[r]||(a.ids[r]=!0,a.milestones.push([r,t]),a.milestones.sort(function(e,t){return new i(t[1]).comparedTo(e[1])})),n+"."+r}},d={};d.upgradedVars={},d.makeUpgraded=function(e,t){console.log("Making Upgrade",e);var n=d.upgradedVars[e]={};n.raw=u.Variables.Index[e],n.raw.id=e+"_raw",u.Variables.Index[n.raw.id]=n.raw;var a=n.raw.invalidates.slice(),r=n.raw.requiredBy.slice();return a.map(function(t){u.Variables.removeInvalidator(t,e)}),r.map(function(t){u.Variables.removeRequirement(t,e)}),delete u.Variables.Index[e],n.flat=u.registerSumVar(e+"_flat",[n.raw.id],t),n.mult=u.registerProductVar(e,[n.flat.id]),a.map(function(t){u.Variables.addInvalidator(t,e)}),r.map(function(t){u.Variables.addRequirement(t,e)}),u.updateVar(n.flat.id,void 0,n.raw.id),n},d.getUpgraded=function(e,t){return d.upgradedVars[e]||d.makeUpgraded(e,t)},d.list={},d.Pedia={},d.owned={},d.unlocked={},d.setUpUnlockFunc=function(){l.dispatch("upgrade.unlocked",this.uID,d.Pedia[this.uID]),console.log("Unlock.this",this),d.setUpBuy(this.uID)},d.setUpUnlock=function(e){if(d.owned[e])return d.setUpValue(e);var t=d.Pedia[e],n=[];u.registerFlipFlopTrigger("upgrade."+e+".unlock",t.unlockedBy,d.setUpUnlockFunc).uID=e;for(var a in t.unlockedBy){var r=t.unlockedBy[a];u.value(r)!==!0&&n.push(u.value(r))}console.log(n)},d.setUpBuyFunc=function(){l.dispatch("upgrade.bought",this.uID,d.Pedia[this.uID]),console.log("Buy.this",this),d.setUpValue(this.uID)},d.setUpBuy=function(e){console.log("SETUP buy",e),u.updateVar("statistics.upgrade.discovered",void 0," "),u.unregisterVar("upgrade."+e+".unlock");var t=d.Pedia[e];d.unlocked[e]=t,u.registerConstant("upgrade."+e+".basePrice",t.shop.price),u.registerProductVar("upgrade."+e+".price",["upgrade."+e+".basePrice"]),u.registerConditionalRootVar("action.upgrade.buy."+e,["upgrade."+e+".price","game.gold.bank"],function(e,t){return t.gte(e)?(this.value=e,!0):void 0}),u.Variables.addInvalidator(u.Variables.Index["action.buy.upgrade"],"action.upgrade.buy."+e),u.registerFlipFlopTrigger("upgrade."+e+".buy",["action.upgrade.buy."+e],d.setUpBuyFunc).uID=e,u.registerLTVar("upgrade."+e+".unaffordable","game.gold.bank","upgrade."+e+".price"),u.updateVar("upgrade."+e+".price",void 0,"upgrade."+e+".basePrice"),d.dispatchUnlocked(e,t)},d.setUpValue=function(e){u.updateVar("statistics.upgrade.bought",void 0," "),u.unregisterVar("upgrade."+e+".basePrice"),u.unregisterVar("upgrade."+e+".price"),u.unregisterVar("action.upgrade.buy."+e),u.unregisterVar("upgrade."+e+".buy"),u.unregisterVar("upgrade."+e+".unaffordable");var t=d.Pedia[e];d.owned[e]=t,d.unlocked[e]&&delete d.unlocked[e];var n=t.targets.map(function(e){var n=d.getUpgraded(e,!0);switch(console.log("getupgrade",t.op),t.op){case"+":return n.flat;case"*":return n.mult}}),a="string"==typeof t.value?t.value:u.registerConstant("upgrade."+e+".value",t.value).id;console.log("uvs",n);for(var r in n){var o=n[r];u.Variables.addInvalidator(o,a),console.log("uv",o,a),u.Variables.addRequirement(o,a),u.updateVar(o,void 0,a)}d.dispatchBought(e,t)},d.unlockedCallbacks=[],d.boughtCallbacks=[],d.dispatchUnlocked=function(e,t){d.unlockedCallbacks.map(function(n){n.call(null,e,t)})},d.dispatchBought=function(e,t){d.boughtCallbacks.map(function(n){n.call(null,e,t)})},d.onUnlocked=function(e){d.unlockedCallbacks.push(e)},d.onBought=function(e){d.boughtCallbacks.push(e)};var p={};!function(){var e=null,t=null;p.setInterval=function(e){t=e},p.start=function(){e=setInterval(function(){u.updateVar("action.time.elapsed")},t)}}();var g={};!function(){function e(e,t){var n=u.value(t);"object"==typeof n&&"undefined"!=typeof n.e&&(n=["BN",n.toString()]),e[t]=n}function t(e,t,n){e[t]=n}g.save=function(){var n={};e(n,"game.gold.bank.exact"),u.Pedia.MonsterIDs.map(function(t){e(n,"monster."+t+".quantity")}),t(n,"action.time.elapsed",Date.now()),console.log("SAVE",n),localStorage.setItem("game.save",JSON.stringify(n)),m.notify("**Game saved**.")},g.load=function(){var e=JSON.parse(localStorage.getItem("game.save"));if(e){console.log(e);for(var t in e){var n=e[t];n[0]&&"BN"===n[0]&&(e[t]=new i(n[1]))}return console.log("LOAD",e),u.Load(e),!0}return!1}}(),o.clickOnMick=function(){console.log("clickOnMick"),u.updateVar("action.click.mick")};var m={};o.interact=function(e){m.interact(e)},o.action=function(e){switch(console.log(e),e){default:u.updateVar(e)}},o.save=function(){return g.save()},o.load=function(){return g.load()},o.updateVarUses=function(e){e?u.updateVarUses(e):Object.keys(u.Variables.Index).map(u.updateVarUses)};var v=function(){Lolipop.action($(this).attr("data-lolipop-action"))};o.updateDOMActions=function(){$(".lolipop-action").off("click",v),$(".lolipop-action").on("click",v)},o.logData=function(){console.log(u)};for(var f in o)"function"==typeof o[f]&&(Lolipop[f]=function(e){return function(){return o[e].apply(this,arguments)}}(f));u.NewGameLoader={"monster.poro.quantity":new i(0),"monster.wolf.quantity":new i(0),"monster.raptor.quantity":new i(0),"monster.krug.quantity":new i(0),"monster.gromp.quantity":new i(0),"monster.blue.quantity":new i(0),"monster.red.quantity":new i(0),"monster.dragon.quantity":new i(0),"monster.vilemaw.quantity":new i(0),"monster.nashor.quantity":new i(0),"game.gold.bank.exact":new i("0"),"game.gold.bank":new i("0"),"game.gold.gpc":new i(1)},u.Pedia={Monsters:{poro:{code:"poro",Recap:{image:"poro",quantity:"monster.poro.quantity",gps:"monster.poro.gps"},SummonMenu:{name:"Poro",description:"This cutie dives in the thick snow of the Freljord to find you some gold. Surprisingly, it actually works. ",image:"poro"}},wolf:{code:"wolf",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Murk Wolf",description:"The flair of a Murk Wolf is one of Runeterra's finests. Gold ores just can't hide.",image:"monster-menu-wolf"}},raptor:{code:"raptor",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Raptor",description:"Once in a while, an awful yet lucrative dysfunction in raptors causes females to lay golden eggs.",image:"monster-menu-blue"}},krug:{code:"krug",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Krug",description:"Being made out of rock sometimes comes with aesthetical downsides. Golden splinters for instance...",image:"blueBIG"}},gromp:{code:"gromp",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Gromp",description:"No one actually knows how gromps can find gold. We only know that they love chewing some.",image:"blueBIG"}},blue:{code:"blue",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Blue Sentinel",description:"Mana can be extracted from blue sentinels' tears. But where does gold come from ? Ow... ",image:"blueBIG"}},red:{code:"red",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Red Brambleback",description:"The back cavity of a brambleback is so hot, that it melts all the surrounding gold magic.",image:"blueBIG"}},dragon:{code:"dragon",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Dragon",description:"Stories on these magical creatures are countless. Many of those include a golden treasure.",image:"blueBIG"}},vilemaw:{code:"vilemaw",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Shadow Isle's Spider",description:"Being related to Vilemaw and the fake God industry is lucrative. Really.",image:"blueBIG"}},nashor:{code:"nashor",Recap:{image:"blue",quantity:"monster.blue.quantity",gps:"monster.blue.gps"},SummonMenu:{name:"Serpentine Worm",description:"Being one of the fiercest creature has its perks. You want gold ? You take it.",image:"blueBIG"}}}},u.Pedia.MonsterIDs=Object.keys(u.Pedia.Monsters),u.Pedia.MonsterIDs.map(function(e){var t=u.Pedia.Monsters[e];t.vars={};var n=t.vars;n.price="monster."+e+".price.1",n.price10="monster."+e+".price.10",n.refund="monster."+e+".refund",n.refundAll="monster."+e+".refundAll",n.actionBuy="action.buy.monster."+e+".1",n.actionBuy10="action.buy.monster."+e+".10",n.actionRefund="action.refund.monster."+e,n.actionRefundAll="action.refundAll.monster."+e,n.quantity="monster."+e+".quantity",n.gps="monster."+e+".gps",n.baseGps="constant.monster."+e+".gps",n.unaffordable="monster."+e+".unaffordable",n.unaffordable10="monster."+e+".unaffordable.10",n.unsellable="monster."+e+".unsellable",n.unsellable10="monster."+e+".unsellable10"}),d.Pedia={C20:{targets:["game.gold.gpc"],op:"*",value:new i("2"),unlockedBy:[c("statistics.mick.clicksAllTime",new i(25))],shop:{price:new i(50),name:"Smashing Click",description:"The amount of gold earned by [mick] is <strong>doubled</strong>.",story:"",image:"smash1"}},C21:{targets:["game.gold.gpc"],op:"*",value:new i("2"),unlockedBy:[c("statistics.mick.clicksAllTime",new i(100))],shop:{price:new i(200),name:"Lucrative Smash",description:"The amount of gold earned by clicking the minion is <strong>doubled</strong>.",story:"",image:"smash2"}},C22:{targets:["game.gold.gpc"],op:"*",value:new i("2"),unlockedBy:[c("statistics.mick.clicksAllTime",new i(300))],shop:{price:new i(1500),name:"Super Smash",description:"The amount of gold earned by clicking the minion is <strong>doubled</strong>.",story:"",image:"smash3"}},P00:{targets:["constant.monster.poro.gps"],op:"+",value:new i("0.1"),unlockedBy:[c("monster.poro.quantity",new i(5))],shop:{price:new i(40),name:"Fluffy Tandem",description:"Each [m=poro,Poros] gains <strong>+0.1</strong> gold per second.",story:"Poros start working in pairs. This is the first step towards the poro network.",image:"poro1"}},P01:{targets:["constant.monster.poro.gps"],op:"*",value:new i("2"),unlockedBy:[c("monster.poro.quantity",new i(10))],shop:{price:new i(300),name:"Thick Furr",description:"[m=poro,Poros] can find gold <strong>twice</strong> as fast.",story:"Awesome story.",image:"poro1"}},P02:{targets:["constant.monster.poro.gps"],op:"*",value:new i("2"),unlockedBy:[c("monster.poro.quantity",new i(30))],shop:{price:new i(5e3),name:"Magma Furr",description:"[m=poro,Poros] can find gold <strong>twice</strong> as fast.",story:"Awesome story.",image:"poro2"}},P03:{targets:["constant.monster.poro.gps"],op:"*",value:new i("2"),unlockedBy:[c("monster.poro.quantity",new i(75))],shop:{price:new i(1e6),name:"Fantom Furr",description:"[m=poro,Poros] can find gold <strong>twice</strong> as fast.",story:"Awesome story.",image:"poro3"}},W00:{targets:["constant.monster.wolf.gps"],op:"+",value:new i("0.5"),unlockedBy:[c("monster.wolf.quantity",new i(5))],shop:{price:new i(400),name:"Wild Nose",description:"[m=wolf,Wolves] now have a better sense of smell and find gold <strong>twice</strong> as fast.",story:"Awesome story.",image:"wolf2"}},W01:{targets:["constant.monster.wolf.gps"],op:"*",value:new i("2"),unlockedBy:[c("monster.wolf.quantity",new i(10))],shop:{price:new i(1500),name:"Wild Nose",description:"[m=wolf,Wolves] now have a better sense of smell and find gold <strong>twice</strong> as fast.",story:"Awesome story.",image:"wolf1"}},R00:{targets:["constant.monster.raptor.gps"],op:"+",value:new i("2"),unlockedBy:[c("monster.raptor.quantity",new i(5))],shop:{price:new i(2e3),name:"Red Raptors",description:"New species of [m=raptor,Raptors] increase the chances of getting golden eggs. #Diversity",story:"Awesome story.",image:"raptor1"}},R01:{targets:["constant.monster.raptor.gps"],op:"*",value:new i("2"),unlockedBy:[c("monster.raptor.quantity",new i(10))],shop:{price:new i(7e3),name:"Red Raptors",description:"New species of [m=raptor,Raptors] increase the chances of getting golden eggs. #Diversity",story:"Awesome story.",image:"raptor1"}},XX0:{targets:["game.gold.gps"],op:"*",value:new i("100000"),unlockedBy:[c("game.gold.bank",new i(0))],shop:{price:new i(0),name:"CHEAT",description:"CHEAAAAT GPS",story:"",image:"poro8"}},XX1:{targets:["game.gold.gpc"],op:"*",value:new i("100000"),unlockedBy:[c("game.gold.bank",new i(0))],shop:{price:new i(0),name:"CHEAT",description:"CHEAAAAT GPC",story:"",image:"poro7"}}},d.pediaEntries=Object.keys(d.Pedia);var h={};h.Utils={},h.Sheet={},h.Utils.txtMapToJSON=function(e,t){var n=h.Sheet[e].sprites={};t.split("\n").map(function(e){var t=e.match(/(\w+) = (\d+) (\d+) (\d+) (\d+)/);if(t){var a=n[t[1]]={};a.x=t[2],a.y=t[3],a.w=t[4],a.h=t[5]}})},h.loadSheet=function(e,t,n){var a=h.Sheet[e]={};a.url=t,a.loaded=!1,$.ajax({url:n,async:!0,success:function(t){h.Utils.txtMapToJSON(e,t),console.log("JSON",h.Sheet),a.loaded=!0}})},u.registerConstant("constant.monster.poro.gps",new i(.2)),u.registerConstant("constant.monster.wolf.gps",new i(1)),u.registerConstant("constant.monster.raptor.gps",new i(5)),u.registerConstant("constant.monster.krug.gps",new i(27)),u.registerConstant("constant.monster.gromp.gps",new i(150)),u.registerConstant("constant.monster.blue.gps",new i(750)),u.registerConstant("constant.monster.red.gps",new i(4321)),u.registerConstant("constant.monster.dragon.gps",new i(2e4)),u.registerConstant("constant.monster.vilemaw.gps",new i(123e3)),u.registerConstant("constant.monster.nashor.gps",new i(666666)),u.registerConstant("constant.monster.poro.price",new i(20)),u.registerConstant("constant.monster.wolf.price",new i(115)),u.registerConstant("constant.monster.raptor.price",new i(800)),u.registerConstant("constant.monster.krug.price",new i(5200)),u.registerConstant("constant.monster.gromp.price",new i(38500)),u.registerConstant("constant.monster.blue.price",new i(29e4)),u.registerConstant("constant.monster.red.price",new i(28e5)),u.registerConstant("constant.monster.dragon.price",new i(235e5)),u.registerConstant("constant.monster.vilemaw.price",new i(275e6)),u.registerConstant("constant.monster.nashor.price",new i(29e8)),u.registerConstant("constant.monster.inflation",new i(1.15)),u.registerVar("action.click.mick",new i(0),null,function(e){return this.value=e||new i(1),!0}),u.registerVar("action.time.elapsed",null,null,function(e){if(null!=this.time&&!e){var t=new i(Date.now()).div(new i(1e3));return this.value=t.minus(this.time),this.time=t,this.value.gt(0)}this.time=new i(e||Date.now()).div(new i(1e3)),this.value=new i(0)});var b=[],y=[];u.Pedia.MonsterIDs.map(function(e){var t="action.buy.monster."+e+".1",n="action.buy.monster."+e+".10",a="action.refund.monster."+e,r="action.refundAll.monster."+e,o={};o[t]=1,o[n]=10,o[a]=-1,o[r]="-current",u.registerSpongeVar("monster."+e+".quantity",o,u.Formatting.abreviatedNumber),u.registerProductVar("monster."+e+".gps",["monster."+e+".quantity","constant.monster."+e+".gps"],u.Formatting.abreviatedNumber),u.registerPriceComputerVar("monster."+e+".price.1","constant.monster."+e+".price","constant.monster.inflation","monster."+e+".quantity",u.Formatting.abreviatedNumber),u.registerPrice10ComputerVar("monster."+e+".price.10","constant.monster."+e+".price","constant.monster.inflation","monster."+e+".quantity",u.Formatting.abreviatedNumber),u.registerRefundComputerVar("monster."+e+".refund","constant.monster."+e+".price","constant.monster.inflation","monster."+e+".quantity",u.Formatting.abreviatedNumber),u.registerRefundAllComputerVar("monster."+e+".refundAll","constant.monster."+e+".price","constant.monster.inflation","monster."+e+".quantity",u.Formatting.abreviatedNumber),u.registerConditionalRootVar(t,["monster."+e+".price.1","game.gold.bank"],function(e,t){return t.gte(e)?(this.value=e,!0):void 0}),u.registerConditionalRootVar(n,["monster."+e+".price.10","game.gold.bank"],function(e,t){return t.gte(e)?(this.value=e,!0):void 0}),u.registerConditionalRootVar(a,["monster."+e+".refund","monster."+e+".quantity"],function(e,t){return t.gt(0)?(this.value=e,!0):void 0}),u.registerConditionalRootVar(r,["monster."+e+".refundAll","monster."+e+".quantity"],function(e,t){return t.gt(0)?(this.value=e,!0):void 0}),u.registerLTVar("monster."+e+".unaffordable","game.gold.bank","monster."+e+".price.1"),u.registerLTVar("monster."+e+".unaffordable.10","game.gold.bank","monster."+e+".price.10"),u.registerLTVar("monster."+e+".unsellable","monster."+e+".quantity",new i(1)),u.registerLTVar("monster."+e+".unsellable10","monster."+e+".quantity",new i(10)),b.push(t),b.push(n),y.push(a),y.push(r)}),u.registerSumVar("monster.gps",u.Pedia.MonsterIDs.map(function(e){return"monster."+e+".gps"})),u.registerRelayVar("action.refund.monster",y),u.registerRelayVar("action.refund",["action.refund.monster"]),d.pediaEntries.map(function(e){d.setUpUnlock(e)}),u.registerRelayVar("action.buy.monster",b),u.registerRelayVar("action.buy.upgrade",[]),u.registerRelayVar("action.buy",["action.buy.monster","action.buy.upgrade"]),u.registerConstant("game.gold.gpc",new i(1)),u.registerRelayVar("game.gold.gps",["monster.gps"]),u.registerProductVar("action.click.goldProduced",["action.click.mick"],["game.gold.gpc"]),u.registerProductVar("action.time.goldProduced",["action.time.elapsed","game.gold.gps"]),u.registerRelayVar("action.goldProduced",["action.click.goldProduced","action.time.goldProduced"]),u.registerSpongeVar("game.gold.bank.exact",{"action.goldProduced":"+value","action.buy":"-value","action.refund":"+value"}),u.registerFloorRelayVar("game.gold.bank",["game.gold.bank.exact"]),u.registerSpongeVar("statistics.mick.clicksAllTime",{"action.click.mick":"+value"}),u.registerIncrementVar("statistics.upgrade.bought"),u.registerIncrementVar("statistics.upgrade.discovered");var m={};m.actions={},m.View={},m.View.list={},m.View.change=function(e){return"back"==e?(m.View.back(),!0):m.View.list[e]?(m.View.current&&m.View.current.close.apply(m.View.current),m.View.current=m.View.list[e],m.View.current.open.apply(m.View.current),window.location.hash="nav-"+e,!0):!1},m.View.back=function(){window.history.back()},function(){function e(n){if(!a&&t.length>0){a=!0;var r=t.pop();$("#notif-bar .relative-layer").append(r);var o=n?1e3:0;setTimeout(function(){r.removeClass("unborn")},o+100),setTimeout(function(){r.addClass("dying"),a=!1,e(!0)},o+2e3),setTimeout(function(){r.remove()},o+3e3)}}var t=[],a=!1;m.notify=function(a){t.push($('<div class="notification unborn fancy-bg dark-red"><p>'+n(a)+"</p></div>")),e()},$(document).ready(function(){})}(),m.interact=function(e){var t=e.getAttribute("data-lolipop")||"";t=t.split(","),t=t.map(function(e){var t=e.match(/([a-z]+):(.*)/);return t&&t[1]&&t[2]?{cat:t[1],val:t[2]}:void 0}).filter(function(e){return e?!0:!1});for(var n in t){var a=t[n];switch(a.cat){case"view":m.View.change(a.val);break;case"action":"action.click.mick"!==a.val&&u.updateVar(a.val)}}},$(document).ready(function(){$(window).on("hashchange",function(e){console.log("hash changed",e),"#nav-"+m.View.current.id!=window.location.hash&&m.View.change(window.location.hash.substring(5))}),l.addListener("upgrade.unlocked",function(e){console.log(">>> EVENT:UNLOCK",e.target)}),l.addListener("upgrade.bought",function(e){console.log(">>> EVENT:UNLOCK",e.target)})}),m.View.list["main-menu"]={removeTimeout:null,open:function(){clearTimeout(this.removeTimeout),$("#main-menu").removeClass("display-none"),setTimeout(function(){$("#main-menu").removeClass("hide-left")},50),$("#global-back-button").addClass("display-none")},close:function(){$("#main-menu").addClass("hide-left"),$("#global-back-button").removeClass("display-none"),this.removeTimeout=setTimeout(function(){$("#main-menu").addClass("display-none")},500)}},m.View.list["monster-list"]={open:function(){function e(e){var o=t[e],i=$("					<div class='w25 acenter section-img round' style='background-image:url(\"../img/mobile/monster-"+o.code+".jpg\");'>					</div>"),s=$("<div class='w75 vtop "+(r?"aleft":"aright")+"'>						<p class='subtitle'>"+o.SummonMenu.name+"</p>						<p class='story'>"+o.SummonMenu.description+"</p>						<p class='info number' style='visibility:hidden;'>_</p>					</div>");u.newMilestoneUse(c("monster."+e+".quantity",1),function(){s.find(".info.number").remove(),
s.append($(n("<p class='info number'>							<span class='gamedata' data-format-function='abbreviatedNumber' data-id='"+o.vars.baseGps+"' >ERR</span>/s x 							<span class='gamedata qty' data-format-function='abbreviatedNumber' data-id='"+o.vars.quantity+"' >ERR</span> [m="+e+","+o.SummonMenu.name+"] = 							<span class='gamedata' data-format-function='abbreviatedNumber' data-id='"+o.vars.gps+"' >ERR</span>/s						</p>"))),Lolipop.updateVarUses(o.vars.quantity),Lolipop.updateVarUses(o.vars.baseGps),Lolipop.updateVarUses(o.vars.gps)});var l=$("					<div class='w20 button buy metal-border fancy-bg blue-radial conditional-format' data-condition='"+o.vars.unaffordable+"' data-format-class='deactivated' onClick='Lolipop.interact(this);' data-lolipop='action:"+o.vars.actionBuy+"'>						<span class='legend'>1</span><span class='gold gamedata' data-format-function='ultraAbbreviated' data-id='"+o.vars.price+"'></span>					</div>					<div class='w20 button buy metal-border fancy-bg blue-radial conditional-format' data-condition='"+o.vars.unaffordable10+"' data-format-class='deactivated' onClick='Lolipop.interact(this);' data-lolipop='action:"+o.vars.actionBuy10+"'>						<span class='legend'>10</span><span class='gold gamedata' data-format-function='ultraAbbreviated' data-id='"+o.vars.price10+"'></span>					</div>					<div class='w20 button sell metal-border fancy-bg red-radial conditional-format' data-condition='"+o.vars.unsellable+"' data-format-class='deactivated' onClick='Lolipop.interact(this);' data-lolipop='action:"+o.vars.actionRefund+"'>						<span class='legend'>1</span><span class='gold gamedata' data-format-function='ultraAbbreviated' data-id='"+o.vars.refund+"'></span>					</div>					<div class='w20 button sell metal-border fancy-bg red-radial conditional-format' data-condition='"+o.vars.unsellable+"' data-format-class='deactivated' onClick='Lolipop.interact(this);' data-lolipop='action:"+o.vars.actionRefundAll+"'>						<span class='legend'><small>all</small></span><span class='gold gamedata' data-format-function='ultraAbbreviated' data-id='"+o.vars.refundAll+"'></span>					</div>					"),d=$('<div class="section underlined"></div>');r?d.append(i).append(s):d.append(s).append(i),d.append(l),a.append(d),Lolipop.updateVarUses(o.vars.price),Lolipop.updateVarUses(o.vars.price10),Lolipop.updateVarUses(o.vars.unaffordable),Lolipop.updateVarUses(o.vars.unaffordable10),Lolipop.updateVarUses(o.vars.unsellable),Lolipop.updateVarUses(o.vars.unsellable10),Lolipop.updateVarUses(o.vars.quantity),Lolipop.updateVarUses(o.vars.refund),Lolipop.updateVarUses(o.vars.refundAll),Lolipop.updateVarUses(o.vars.baseGps),Lolipop.updateVarUses(o.vars.gps),r=!r,setTimeout(function(){a.removeClass("hide-right")},50)}clearTimeout(this.removeTimeout),this.removeDiv(),$("#windows-insertion").append($("				<div class='scroll' style='-webkit-overflow-scrolling: touch;'>					<div id='monster-list' class='text-section horizontal-hide hide-right'></div>				</div>			"));var t=u.Pedia.Monsters,a=$("#monster-list");a.append($("<div class='title'>Monsters</div>")),m.Scroll.reset(),m.Scroll.turnOn(a.parent());var r=!0,o=null;for(var i in t)o?!function(){var t=i+"";u.newMilestoneUse(c("monster."+o+".quantity",1),function(){e(t)})}():e(i),o=i},removeTimeout:null,removeDiv:function(){$("#monster-list").remove()},close:function(){m.Scroll.turnOff($("#monster-list").parent()),$("#monster-list").addClass("hide-right"),this.removeTimeout=setTimeout(this.removeDiv,700)},back:"main-menu"},String.prototype.hexEncode=function(){var e,t,n="";for(t=0;t<this.length;t++)e=this.charCodeAt(t).toString(16),n+=("000"+e).slice(-4);return n},m.View.list["enchants-list"]={onNewUpgrade:function(){$("#reload-fixed").removeClass("display-none")},onUpgradeBought:function(e){console.log("Event:Bought",e.target),$("#U"+e.target).addClass("bought").find(".button .gold").text("Used")},open:function(){clearTimeout(this.removeTimeout),this.removeDiv(),console.log("Opening enchants-list"),$("#windows-insertion").append($("				<div  class='scroll' style='-webkit-overflow-scrolling: touch;'>				<div id='enchants-list' class='text-section window horizontal-hide hide-right'></div>				</div>			"));var e=$("#enchants-list");m.Scroll.reset(),m.Scroll.turnOn(e.parent()),$reload=$('<div id="reload-fixed" class="no-select display-none"><div><span>New spells available</span></div></div>'),e.append($reload);var t=this;$reload.click(function(){t.close(),t.open()}),e.append($('<div class="title">Available</div>')),console.log(d.Pedia);for(var a in d.Pedia)var r=d.unlocked[a];for(var a in d.unlocked){var r=d.unlocked[a];a.substring(1).hexEncode().substring(2);e.append($("					<div id='U"+a+"' class='section aleft underlined'>						<div class='w5'>						</div>						<div class='w70'>							<p class='subtitle'>"+r.shop.name+"</p>							<p class='story'>"+n(r.shop.story)+"</p>							<p class='description'>"+n(r.shop.description)+"</p>						</div>						<div class='w15 button fancy-bg blue-radial no-legend acenter buy metal-border conditional-format' data-lolipop='action:action.upgrade.buy."+a+"' onClick='Lolipop.interact(this);' data-condition='upgrade."+a+".unaffordable' data-format-class='deactivated' onClick='Lolipop.interact(this);' data-lolipop='action:'>							<!--<span class='legend'>buy</span>--><span class='gold gamedata' data-format-function='ultraAbbreviated' data-id='upgrade."+a+".price'>ERR</span>						</div>					</div>				")),Lolipop.updateVarUses("upgrade."+a+".unaffordable"),Lolipop.updateVarUses("upgrade."+a+".price")}e.append($('<div class="title">Performed</div>')),l.addListener("upgrade.unlocked",this.onNewUpgrade),l.addListener("upgrade.bought",this.onUpgradeBought),setTimeout(function(){e.removeClass("hide-right")},50)},removeTimeout:null,removeDiv:function(){$("#enchants-list").parent().remove()},close:function(){m.Scroll.turnOff($("#enchants-list").parent()),l.removeListener("upgrade.unlocked",this.onNewUpgrade),$("#enchants-list").addClass("hide-right"),this.removeTimeout=setTimeout(this.removeDiv,700)},back:"main-menu"},m.View.list["spells-window"]={code:"spells-window",onNewUpgrade:function(){$("#reload-fixed").removeClass("display-none")},onUpgradeBought:function(e){console.log("Event:Bought",e.target),$("#U"+e.target).addClass("bought").find(".button .gold").text("Used")},open:function(){clearTimeout(this.removeTimeout),this.removeDiv(),console.log("Opening "+this.code),$("#windows-insertion").append($("				<div  class='scroll' style='-webkit-overflow-scrolling: touch;'>				<div id='"+this.code+"' class='text-section window horizontal-hide hide-right'></div>				</div>			"));var e=$("#"+this.code);m.Scroll.reset(),m.Scroll.turnOn(e.parent()),e.append($('<div class="title">SPELLBOOK <small>(1/254)</small></div>'));for(var t=0;5>t;++t)$section=$('					<div class="section underlined">						<div class="subtitle">Fierce & Fluffy</div>						<div class="w80 no-select spell-block metal-border fancy-bg grey-brown-radial radial-center">							<p class="description full-center">'+n("[m=poro,Poro] gain *+5%* production for each [m=wolf,Wolf]")+'</p>						</div>						<div class="w80 no-select spell-block metal-border fancy-bg grey-brown-radial radial-center selected">							<p class="description full-center">'+n("[m=wolf,Wolf] gain *+2%* production for each [m=poro,Poro]")+"</p>						</div>					</div>"),e.append($section);e.append($('				<div class="section">					<p class="story">Spells yet to be discovered:<br/><strong>253</strong></p>				</div>')),setTimeout(function(){e.removeClass("hide-right")},50)},removeTimeout:null,removeDiv:function(){$("#"+this.code).parent().remove()},close:function(){m.Scroll.turnOff($("#"+this.code).parent()),l.removeListener("upgrade.unlocked",this.onNewUpgrade),$("#"+this.code).addClass("hide-right"),this.removeTimeout=setTimeout(this.removeDiv,700)},back:"main-menu"};for(var w in m.View.list)m.View.list[w].id=w;m.Scroll={},function(){var e,t=0,n=0,a=(m.Scroll.divID="windows-insertion",null);m.Scroll.reset=function(){},m.Scroll.turnOn=function(r,o){a=r,o&&"undefined"!=typeof o.y0&&"undefined"!=typeof o.dy0&&"undefined"!=typeof o.dy&&(e=o.dy,n=o.dy0,t=o.y0,a.get(0).style.webkitTransform="translateY("+e+n+"px)")},m.Scroll.turnOff=function(r){return(!r||r&&a.is(r))&&(a=null),{y0:t,dy0:n,dy:e}}}(),m.View.change("main-menu"),function(){function e(e,t){var n=h.Sheet.upgrades,a=n.sprites[t.shop.image];return console.log("sprite",a,n),$("<div class='enchant-holder locked lolipop-action conditional-format' data-upgrade-id='"+e+"' data-lolipop-action='action.upgrade.buy."+e+"' data-condition='upgrade."+e+".affordable' data-format-class='affordable' data-format-function='abbreviatedNumber''>						<div class='sprite-overlay'>							<div class='title'>"+t.shop.name+"</div>							<div class='description'>"+t.shop.description+"</div>							<div class='price gamedata' data-format-function='abbreviatedNumber' data-id='upgrade."+e+".price'>ERR_PRICE</div>							<div class='tip'>Click to buy</div>						</div>						<div class='oval'>							<div class='sprite-bg' style='background-image: url("+n.url+"); background-position: -"+a.x+"px -"+a.y+"px;'></div>						</div>					</div>					<!--line break-->")}BigNumber.config({EXPONENTIAL_AT:100}),$(".monster-action .options-holder").on("mouseenter",function(){$(this).siblings(".description-holder").find(".opt-default").css("display","none")}),$(".monster-action .options-holder > .opt").on("mouseenter",function(){var e=$(this).attr("data-opt");$(this).closest(".monster-action").find(".description-holder .opt[data-opt='"+e+"']").css("display","block")}),$(".monster-action .options-holder > .opt").on("mouseleave",function(){var e=$(this).attr("data-opt");$(this).closest(".monster-action").find(".description-holder .opt[data-opt='"+e+"']").css("display","")}),$(".monster-action .options-holder").on("mouseleave",function(){$(this).siblings(".description-holder").find(".opt-default").css("display","")}),h.loadSheet("upgrades","img/sprites/upgrade-sheet.png","img/sprites/upgrade-sheet.txt");var t=function(n,a){return h.Sheet.upgrades.loaded?(console.log("UNLOCKED",n),$("#enchants-ctn").append(e(n,a)),Lolipop.updateDOMActions(),Lolipop.updateVarUses("upgrade."+n+".price"),void Lolipop.updateVarUses("upgrade."+n+".affordable")):(console.log("Delaying Shop Entry",n),void setTimeout(function(){t(n,a)},100))};d.onUnlocked(t),d.onBought(function(e,t){$div=$(".enchant-holder[data-upgrade-id='"+e+"']"),console.log("BOUGHT",$div,$div.children(".oval")),$div.removeClass("locked"),$div.find(".price, .tip").remove()}),u.newOneTimeUse(c("game.gold.bank",5),function(){$('#main-menu > div[data-cat="monsters"]').removeClass("display-none")}),u.newOneTimeUse(c("game.gold.bank",10),function(){$("#monster-menu-poro").removeClass("display-none")}),u.newOneTimeUse(c("statistics.upgrade.discovered",1),function(){console.log("REACHED"),$("#enchants-section").removeClass("display-none")}),u.Pedia.MonsterIDs.map(function(e,t,n){t!=n.length&&u.newOneTimeUse(c("monster."+e+".quantity",1),function(){$("#monster-menu-"+n[t+1]).removeClass("display-none")})}),o.load()||u.Load(u.NewGameLoader),p.setInterval(32),p.start()}(),$(document).ready(function(){function e(e,t,n){var a=u.Formatting.Functions.abbreviatedNumber(u.value("game.gold.gpc")),r=n?n:parseInt($("body").css("width")),o=(Math.random()-.5)/4,i=$('<div class="fixed fading gold">+'+a+"</div>").css({left:e+r*o,top:t});$("#efx").append(i),setTimeout(function(){i.addClass("up"),i.css("opacity",0)},10),setTimeout(function(){i.remove()},1e3)}var t=!0;$("#save-item").click(function(){$(this).children(".bg").css("transform","rotateY("+(t?180:0)+"deg)"),console.log("ROTATE"),t=!t}),l.addListener("upgrade.unlocked",function(e){try{m.notify("Spell discovered: *"+e.data.shop.name+"*")}catch(e){m.notify("Spell discovered")}}),$("#main-button, #left-main-button, #right-main-button").on("touchstart",function(t){$(this).addClass("active");var n=t.originalEvent.touches[t.originalEvent.touches.length-1];u.updateVar("action.click.mick")&&e(n.pageX,n.pageY)}).on("touchend",function(e){e.preventDefault(),$(this).removeClass("active")}),$("#main-button, #left-main-button, #right-main-button").on("click",function(t){u.updateVar("action.click.mick")&&e(t.pageX,t.pageY)}),$(window).keyup(function(t){if((83===t.keyCode||75===t.keyCode)&&u.updateVar("action.click.mick")){var n=parseInt($(window).width()),a=parseInt($(window).height());n>=a?83===t.keyCode?e(.1*n,a/2,.2*n):e(.9*n,a/2,.2*n):e(.5*n,.8*a)}})})}(),$("#mick").on("click",function(){Lolipop.action("action.click.mick")}),$(document).ready(function(){Lolipop.updateDOMActions(),Lolipop.updateVarUses()});